{
  "id": "e050938b",
  "title": "Use Unicode box-drawing and block characters for map tiles",
  "tags": [
    "quality-of-life",
    "renderer",
    "map"
  ],
  "status": "done",
  "created_at": "2026-02-15T03:00:03.466Z"
}

## Goal
Replace ASCII map characters (`#` for walls, `.` for floors) with Unicode characters for
a more visually appealing dungeon. Terminals that run this game already support Unicode
(the renderer uses box-drawing `┌─┐│└┘` for panels).

## Existing Code Context
- `src/map/game-map.ts` — `FLOOR_TILE` and `WALL_TILE` constants define the default tile
  characters. `FLOOR_TILE.char = "."`, `WALL_TILE.char = "#"`.
- `src/map/dungeon-generator.ts` — `carveRoom()` and `carveCorridor()` spread `FLOOR_TILE`
  and the default map fill is `WALL_TILE`. No context-aware tile selection.
- `src/map/room-builder.ts` — test room builder, also uses `FLOOR_TILE` / `WALL_TILE`.
- `src/renderer/ansi.ts` — already renders Unicode (box-drawing chars in `drawBox()`).
- `src/game.ts` — legend line shows `#:wall .:floor` — update if characters change.

## Requirements

### New Tile Characters

**Floor tiles:**
- Room floor: `·` (middle dot, U+00B7) — subtle, doesn't clutter the view
- Corridor floor: `·` (same as room floor for now)

**Wall tiles — context-aware:**
Use box-drawing characters based on adjacent walls. After dungeon generation is complete,
run a post-processing pass that examines each wall tile's cardinal neighbors (N/S/E/W)
and selects the appropriate character:

| Adjacent Walls | Character | Name                    |
| -------------- | --------- | ----------------------- |
| None           | `■`       | Pillar / isolated wall  |
| N+S            | `│`       | Vertical wall           |
| E+W            | `─`       | Horizontal wall         |
| N+E            | `└`       | Corner bottom-left      |
| N+W            | `┘`       | Corner bottom-right     |
| S+E            | `┌`       | Corner top-left         |
| S+W            | `┐`       | Corner top-right        |
| N+S+E          | `├`       | T-junction left         |
| N+S+W          | `┤`       | T-junction right        |
| E+W+S          | `┬`       | T-junction top          |
| E+W+N          | `┴`       | T-junction bottom       |
| N+S+E+W        | `┼`       | Cross junction          |
| E only         | `─`       | Horizontal stub         |
| W only         | `─`       | Horizontal stub         |
| N only         | `│`       | Vertical stub           |
| S only         | `│`       | Vertical stub           |

A neighbor counts as "wall" if it's out of bounds OR is a wall tile.

### Implementation

#### `src/map/game-map.ts`
- Update `FLOOR_TILE.char` to `·`
- Keep `WALL_TILE.char` as `#` (default, overwritten by post-processing)
- Update wall color: `fg: 'gray'` instead of `'white'` for a subtler look

#### `src/map/dungeon-generator.ts`
Add a post-processing function called after room and corridor carving:

```typescript
function assignWallCharacters(map: GameMap): void
```

Iterate every tile. For each wall tile, check its 4 cardinal neighbors (treating
out-of-bounds as wall), and set `tile.char` to the appropriate box-drawing character
from the table above.

Call this at the end of `generateDungeon()` before returning.

#### `src/map/room-builder.ts`
Apply the same `assignWallCharacters()` post-processing to the test room. Either export
the function from dungeon-generator or extract it to a shared utility (e.g.,
`src/map/tile-utils.ts`) so both can use it.

#### `src/game.ts`
Update the legend line to reflect new characters.

## Design Constraints
- Single-width characters only — no full-width Unicode that would break grid alignment
- The characters chosen must be in the Unicode Box Drawing block (U+2500–U+257F) which
  is supported by virtually all modern terminal emulators
- `·` (middle dot) is U+00B7, part of Latin-1 Supplement — universally supported
- Don't change the Tile interface or any game logic — this is purely visual

## Tests
No automated tests — visual concern. Verify manually:
- Walls form clean connected lines with proper corners and junctions
- Corridors have smooth wall transitions where they meet rooms
- Isolated wall blocks (pillars) show as `■`
- Floor tiles show `·` instead of `.`
- Fog of war dimming still works with new characters

## Definition of Done
- Dungeon walls render as connected box-drawing lines instead of `#`
- Floor tiles render as `·` instead of `.`
- Corners, T-junctions, and straight walls all use correct characters
- Test room (room-builder.ts) also uses new characters
- `bun test` still passes (no regressions)
