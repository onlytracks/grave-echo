{
  "id": "32ac32d0",
  "title": "Terrain glyph palette — map tile types for zones and world features",
  "tags": [
    "art",
    "map",
    "worldgen",
    "glyphs"
  ],
  "status": "done",
  "created_at": "2026-02-16T00:24:14.935Z"
}

## Goal
Define terrain tile types with Nerd Font glyphs for zone variety. Currently only
two tile types exist (Floor `·` and Wall `▓`). Zones need distinct terrain to
feel like different places — a corrupted forest can't just be gray dots in green.

This todo is a prerequisite for TODO-061ba800 (zone system) which incorrectly
claims "No new tile types needed."

## Glyph Source
**Nerd Fonts Material Design icons** (`nf-md-*`). The game already uses these for
items and entities (sword `\u{F04E5}`, axe `\u{F08C8}`, etc.) — confirmed rendering
in the game grid. Single-width in any Nerd Font patched terminal.

Full searchable list: https://github.com/8bitmcu/NerdFont-Cheat-Sheet
Also consult AGENTS.md zomia reference for Unicode fallbacks.

## Rendering Verification
Tested in terminal — all Nerd Font MD icons below render single-width and align
correctly in a grid alongside `▓` walls, `·` floors, and `@` player. The game
already depends on Nerd Fonts for item glyphs, so no new font requirement.

**Previously broken Unicode glyphs** (emoji, double-width, invisible):
`⏬` `⏫` `░` `֍` `֎` `᳁` `᳃` `ඦ` `⍾` `☠` `◦` — all replaced below.

## Current Tile Types
```typescript
enum TileType { Floor, Wall }
// Floor: · (gray on black), walkable, transparent
// Wall:  ▓ (white on black), !walkable, !transparent
```

## Proposed Tile Types

### Universal (All Zones)
| Tile          | Glyph | Code     | Name            | fg            | Properties              | Notes                        |
|---------------|-------|----------|-----------------|---------------|-------------------------|------------------------------|
| Floor         | `·`   | U+B7     | middle dot      | zone-colored  | walkable, transparent   | Existing, color varies       |
| Wall          | `▓`   | U+2593   | dark shade      | zone-colored  | !walkable, !transparent | Existing, color varies       |
| Door (open)   | 󰠜    | F081C    | door-open       | brown         | walkable, transparent   | Zone transitions             |
| Door (closed) | 󰠛    | F081B    | door-closed     | brown         | !walkable, !transparent | Future: interact to open     |
| Stairs Down   | 󱊾    | F12BE    | stairs-down     | brightYellow  | walkable, transparent   | Distinct from `>` convention |
| Stairs Up     | 󱊽    | F12BD    | stairs-up       | brightYellow  | walkable, transparent   | Distinct from `<` convention |
| Rubble        | `•`   | U+2022   | bullet          | darkGray      | walkable, transparent   | Simple, always renders       |
| Pit           | `◇`   | U+25C7   | white diamond   | darkGray      | !walkable, transparent  | Can see across, can't cross  |

### Verdant Threshold (Corrupted Forest)
| Tile            | Glyph | Code     | Name            | fg           | Properties              | Notes                           |
|-----------------|-------|----------|-----------------|--------------|-------------------------|---------------------------------|
| Grass           | 󱔐    | F1510    | grass           | green        | walkable, transparent   | Open areas between trees        |
| Tall grass      | 󱔐    | F1510    | grass           | darkGreen    | walkable, !transparent  | Same glyph, darker = taller     |
| Tree            | 󰔱    | F0531    | tree            | green        | !walkable, !transparent | Forest walls — organic feel     |
| Pine tree       | 󰐅    | F0405    | pine-tree       | green        | !walkable, !transparent | Variety in forest walls         |
| Corrupted tree  | 󰔱    | F0531    | tree            | darkMagenta  | !walkable, !transparent | Same glyph, corruption color    |
| Mushroom        | 󰟟    | F07DF    | mushroom        | brightGreen  | walkable, transparent   | Glowing, decorative             |
| Flower          | 󰉊    | F024A    | flower          | yellow       | walkable, transparent   | Uncorrupted areas               |
| Corrupted bloom | 󰉊    | F024A    | flower          | magenta      | walkable, transparent   | Same glyph, corruption color    |
| Leaf (ground)   | 󰌪    | F032A    | leaf            | darkGreen    | walkable, transparent   | Forest floor scatter            |
| Sprout          | 󰹦    | F0E66    | sprout          | green        | walkable, transparent   | New growth areas                |
| Shallow water   | 󰖌    | F058C    | water           | blue         | walkable, transparent   | Slows movement (future)         |
| Deep water      | 󰞍    | F078D    | waves           | darkBlue     | !walkable, transparent  | Can see across, can't cross     |

### Dungeon (The Hollow Warren)
| Tile           | Glyph | Code     | Name            | fg          | Properties              | Notes                          |
|----------------|-------|----------|-----------------|-------------|-------------------------|--------------------------------|
| Stone floor    | `·`   | U+B7     | middle dot      | gray        | walkable, transparent   | Standard dungeon               |
| Cracked floor  | `◇`   | U+25C7   | white diamond   | darkGray    | walkable, transparent   | Decorative, shows age          |
| Rubble         | `•`   | U+2022   | bullet          | darkGray    | walkable, transparent   | Collapsed areas                |
| Pillar         | 󰜂    | F0702    | pillar          | white       | !walkable, transparent  | LOS blocker in open rooms      |
| Barrel         | 󰁴    | F0074    | barrel          | brown       | !walkable, transparent  | Dungeon furniture              |
| Cobweb         | 󰯊    | F0BCA    | spider-web      | white       | walkable, transparent   | Decorative, abandoned feel     |
| Torch (wall)   | 󱘆    | F1606    | torch           | brightYellow| walkable, transparent   | Light source marker            |
| Treasure chest | 󰜦    | F0726    | treasure-chest  | yellow      | walkable, transparent   | Loot room marker               |

### Boss Dungeon / Corruption Core
| Tile             | Glyph | Code     | Name            | fg           | Properties              | Notes                       |
|------------------|-------|----------|-----------------|--------------|-------------------------|-----------------------------|
| Corrupted floor  | `·`   | U+B7     | middle dot      | darkRed      | walkable, transparent   | Standard but ominous         |
| Corruption vein  | `~`   | U+7E     | tilde           | magenta      | walkable, transparent   | Simple, always renders       |
| Bone pile        | 󰂹    | F00B9    | bone            | white        | walkable, transparent   | Decorative, lore             |
| Skull            | 󰚌    | F068C    | skull           | white        | walkable, transparent   | Place of death marker        |
| Grave marker     | 󰮢    | F0BA2    | grave-stone     | gray         | !walkable, transparent  | Thematic obstacle            |
| Coffin           | 󰭿    | F0B7F    | coffin          | darkGray     | !walkable, transparent  | Boss area furniture          |
| Dark flame       | 󰈸    | F0238    | fire            | red          | !walkable, transparent  | Hazard — damages on contact? |
| Crystal          | 󰬯    | F0B2F    | crystal-ball    | magenta      | !walkable, transparent  | Corruption source            |

### Hub (Echoed Sanctuary) — Future
| Tile           | Glyph | Code     | Name            | fg          | Properties              | Notes                          |
|----------------|-------|----------|-----------------|-------------|-------------------------|--------------------------------|
| Campfire       | 󰻝    | F0EDD    | campfire        | brightYellow| walkable, transparent   | Central hub warmth             |
| Fountain       | 󰥫    | F096B    | fountain        | cyan        | !walkable, transparent  | Hub landmark                   |
| Tent           | 󰔈    | F0508    | tent            | brown       | !walkable, !transparent | Merchant/NPC shelter           |
| Flag           | 󰈻    | F023B    | flag            | red         | walkable, transparent   | Waypoint marker                |
| Gate (portal)  | 󰊙    | F0299    | gate            | brightCyan  | walkable, transparent   | Zone portal entrance           |

## Implementation

### TileType Enum Extension
```typescript
enum TileType {
  Floor, Wall,
  // Universal
  DoorOpen, DoorClosed, StairsDown, StairsUp, Rubble, Pit,
  // Nature
  Grass, TallGrass, Tree, PineTree, CorruptedTree, Mushroom, Flower,
  CorruptedBloom, Leaf, Sprout, ShallowWater, DeepWater,
  // Dungeon
  CrackedFloor, Pillar, Barrel, Cobweb, Torch, TreasureChest,
  // Boss/Corruption
  CorruptionVein, BonePile, Skull, GraveMarker, Coffin, DarkFlame, Crystal,
  // Hub
  Campfire, Fountain, Tent, Flag, Portal,
}
```

### Tile Constants
Each tile type gets a constant with its Nerd Font glyph:

```typescript
export const TREE_TILE: Tile = {
  type: TileType.Tree,
  char: "\u{F0531}",  // nf-md-tree
  fg: "green",
  bg: "black",
  walkable: false,
  transparent: false,
};
```

### Tile Factory
Create tile factory functions per zone type so the dungeon generator can
request themed tiles:

```typescript
function makeForestFloor(rng): Tile
  // 60% grass, 15% leaf, 10% flower, 10% mushroom, 5% sprout

function makeForestWall(rng): Tile
  // 50% tree, 30% pine, 20% corrupted tree (increases with intensity)

function makeDungeonFloor(rng): Tile
  // 70% stone, 15% cracked, 10% rubble, 5% cobweb

function makeDungeonWall(rng): Tile
  // 90% wall, 10% pillar (only in large rooms)

function makeBossFloor(rng): Tile
  // 60% corrupted floor, 20% corruption vein, 10% bone pile, 10% skull

function makeBossWall(rng): Tile
  // 70% wall (dark red), 15% grave marker, 15% coffin
```

### Color Strategy
Same Nerd Font glyph can represent different things via color:
- Tree (green) vs Corrupted Tree (darkMagenta) — same `\u{F0531}`
- Grass (green) vs Tall Grass (darkGreen) — same `\u{F1510}`
- Flower (yellow) vs Corrupted Bloom (magenta) — same `\u{F024A}`
- Fire (brightYellow/red) vs Dark Flame (red/darkRed) — same `\u{F0238}`

This reduces the number of unique glyphs while maintaining visual variety.

### Gameplay Properties
Each tile needs these properties:
- `walkable` — can entities move onto it?
- `transparent` — does it block LOS?

Consider adding optional `movementCost: number` to Tile interface now
(default 1) even if nothing reads it yet — avoids a refactor for tall grass/water.

## Nerd Font Dependency Note
The game already requires a Nerd Font for item glyphs (sword, axe, bow, shield,
armor, ring, potions — all `\u{F****}` codepoints in item-factory.ts). Terrain
glyphs add no new dependency. If a user doesn't have a Nerd Font, items are
already broken — terrain won't make it worse.

## Files to Change
- `src/map/game-map.ts` — extend TileType enum, add new tile constants
- `src/map/tile-utils.ts` — tile factory functions per zone theme
- `src/map/dungeon-generator.ts` — use themed tiles during room generation
- `src/renderer/panels/game-grid.ts` — ensure new tiles render correctly
- `src/ecs/systems/movement.ts` — respect walkable property (already does)
- `src/ecs/systems/sensory.ts` — respect transparent property (already does)

## Dependencies
- Should be done **before** or **alongside** TODO-061ba800 (zone system)
- Stairs tiles needed by TODO-11316f7c

## Definition of Done
- TileType enum has terrain variety beyond Floor/Wall
- Each zone type has a distinct visual palette using Nerd Font MD icons
- Tile factory functions produce themed terrain with weighted randomness
- Color distinguishes corruption level (green → darkMagenta)
- Movement and LOS systems respect new tile properties
- `bun test` passes
