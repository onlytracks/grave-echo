{
  "id": "389af4ff",
  "title": "Phase 0a.3: Game Map + Hardcoded Room",
  "tags": [
    "phase-0a",
    "map",
    "foundation"
  ],
  "status": "pending",
  "created_at": "2026-02-14T22:58:43.514Z"
}

## Goal
Create a map/grid data structure and a hardcoded test room for the player to walk around in.

## Read First
- `AGENTS.md` — project constraints
- `docs/technical.md` — map representation (open question, decide here)

## Dependencies
- Requires: Phase 0a.1 (ECS Core) completed

## Requirements

### `src/map/game-map.ts` — Map Data Structure
The game map is a 2D grid of tiles, separate from the ECS entity layer.

```typescript
enum TileType {
  Floor,
  Wall,
}

interface Tile {
  type: TileType;
  char: string;    // display character: '.' for floor, '#' for wall
  fg: string;      // foreground color
  bg: string;      // background color
  walkable: boolean;
  transparent: boolean;  // for future FOV
}

class GameMap {
  width: number;
  height: number;
  tiles: Tile[][];

  getTile(x: number, y: number): Tile | undefined;
  isWalkable(x: number, y: number): boolean;
  isInBounds(x: number, y: number): boolean;
}
```

### Why tiles are NOT entities
Tiles are static terrain — potentially thousands of them. Making each tile an ECS entity
would bloat queries. Entities sit ON TOP of the map. The map is the stage; entities are
the actors. The GameGrid panel renders the map first, then entities on top.

### `src/map/room-builder.ts` — Hardcoded Test Room
Create a simple function that returns a GameMap:
- 20 tiles wide, 15 tiles tall
- Walls around the border (# character, gray)
- Floor in the interior (. character, dark gray)
- A few interior walls to test collision (L-shapes, pillars)
- This is throwaway — it will be replaced by procedural generation later

### Map Rendering Integration
The GameGrid panel (from Phase 0a.2) needs to render the map:
- First draw all map tiles
- Then draw entities on top (entities at a position override the tile character)

## Tests (`src/map/__tests__/game-map.test.ts`)
- `isInBounds` returns true for valid coords, false for invalid
- `isWalkable` returns true for floor, false for wall
- `getTile` returns undefined for out-of-bounds coords
- Hardcoded room has walls on all borders
- Hardcoded room has walkable interior

## Definition of Done
- GameMap class with tile storage and query methods
- Hardcoded 20x15 room with border walls and interior obstacles
- GameGrid panel renders the map tiles
- `bun test` passes all map tests
